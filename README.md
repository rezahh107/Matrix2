# ุณุงูุงูู ุชุฎุตุต ุฏุงูุดุฌู-ููุชูุฑ (ูุณุฎู ูุนูุงุฑ ูุฏููุงุฑ)

## ุงุฌุฑุง
```bash
pip install -r requirements.txt
python -m app.main
```

## ุณุงุฎุช ูุงู ุงุฌุฑุง (PyInstaller)
```bash
pyinstaller --onefile --windowed --name ุชุฎุตุต_ุฏุงูุดุฌู_ููุชูุฑ \
  --collect-all PySide6 --hidden-import openpyxl --hidden-import pandas.io.formats.excel \
  app/main.py
```

## Policy-First ุฏุฑ Core

- ุชูุงู ูุงู ุณุชููโูุงุ ูุฑุงุญู Trace ู ููุชุฑูุง ุงุฒ ูุงู `config/policy.json` ุฎูุงูุฏู ูโุดููุฏ.
- ฺฉูุงุณ `PolicyAdapter` ุฏุฑ `app/core/policy_adapter.py` ุชููุง ููุทูู ุฏุณุชุฑุณ ุจู ุชูุธูุงุช Policy ุงุณุช.
- ุจุฑุง ุชุบุฑ ุฑูุชุงุฑ ููุชุฑูุงุ ุชููุง ฺฉุงู ุงุณุช JSON ุฑุง ูุฑุงุด ฺฉูุฏุ ูุงุฒ ุจู ุชุบุฑ ฺฉุฏ ูุณุช.
- ุณุชูู ุธุฑูุช ุงุฒ ูุฑุญููู `capacity_gate` ฺฏุฑูุชู ูโุดูุฏ ู ุจุฑุง Override ูโุชูุงู ูพุงุฑุงูุชุฑ ุตุฑุญ ุจู ุชุงุจุน ุชุฎุตุต ุฏุงุฏ.

## ูุฑูุงูโุณุงุฒ ูุฑูุฏ

- ุญุฑูู ุนุฑุจ (ู/ู) ู ุงุฑูุงู ูุงุฑุณ/ุนุฑุจ ุจู ูุนุงุฏู ูุงุฑุณ/ูุงุชู ุชุจุฏู ูโุดููุฏ.
- ูุงุตููโูุงุ ููโูุงุตูู ู ฺฉุงุฑุงฺฉุชุฑูุง ุชุฑฺฉุจ ุญุฐู ูโุดููุฏ ุชุง ููุงุณูู ุณุชููโูุง ูพุงุฏุงุฑ ุจูุงูุฏ.
- ุขูุงุณโูุง ุงุฒ Policy ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง ฺฏุฒุงุฑุด Inspactor ู Crosswalk ุงุณุชูุงุฏู ูโุดููุฏ.

## ุชุณุชโูุง ุณุงุณุชโูุญูุฑ

- `pytest -q` ุณูุงุฑููุง ุชุฑุฌุญ ยซฺฉุฏุฑุดุชูยป ุจุฑ ูุงู ฺฏุฑูู ู ูุตุฑู ุณุชูู ุธุฑูุช ุงุฒ Policy ุฑุง ูพูุดุด ูโุฏูุฏ.
- ุชุบุฑ JSON (ูุซูุงู ุชุบุฑ ูุงู ุณุชูู ุธุฑูุช) ุจุงุฏ ุจุฏูู ุชุบุฑ ฺฉุฏ ุจุงุนุซ ุชุบุฑ ุฑูุชุงุฑ ุชุฎุตุต ุดูุฏ.

## ๐ข ูุฏุฑุช ูุฑุงฺฉุฒ

ุณุณุชู ุงุฒ ูุฏุฑุช ูพุดุฑูุชู ูุฑุงฺฉุฒ ูพุดุชุจุงู ูโฺฉูุฏ ฺฉู ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ูุฑุงฺฉุฒ ูุฎุชูู ุฑุง ุชุนุฑู ฺฉุฑุฏู ู ุจุฑุง ูุฑ ูุฑฺฉุฒ ูุฏุฑุงู ูุดุฎุต ุชุนู ฺฉูุฏ.

### ูพฺฉุฑุจูุฏ ูุฑุงฺฉุฒ

ูุฑุงฺฉุฒ ุฏุฑ ูุงู JSON ุงุตู ุณุณุชู ุนู `config/policy.json` ุชุนุฑู ูโุดููุฏ (ูุณุชูโ ุจุฑูุงูู ูฺ ูุงู YAML ุฑุง ุจุงุฑฺฏุฐุงุฑ ููโฺฉูุฏุ ุงฺฏุฑ ูุณุฎูโ YAML ุฏุฑ ุงุฎุชุงุฑ ุฏุงุฑุฏ ุจุงุฏ ุขู ุฑุง ุจู JSON ุชุจุฏู ฺฉุฑุฏู ู ุณูพุณ ุจุฑูุงูู ุฑุง ุงุฌุฑุง ฺฉูุฏ):

```json
{
  "center_management": {
    "enabled": true,
    "default_center_for_invalid": 0,
    "strict_manager_validation": false,
    "school_student_column": "is_school_student",
    "centers": [
      {
        "id": 1,
        "name": "ฺฏูุณุชุงู",
        "default_manager": "ุดูุฏุฎุช ฺฉุดุงูุฑุฒ",
        "description": "ูุฑฺฉุฒ ฺฏูุณุชุงู"
      },
      {
        "id": 2,
        "name": "ุตุฏุฑุง",
        "default_manager": "ุขูุงุฒ ููุดููุฏ",
        "description": "ูุฑฺฉุฒ ุตุฏุฑุง"
      },
      {
        "id": 0,
        "name": "ูุฑฺฉุฒ",
        "default_manager": null,
        "description": "ูุฑฺฉุฒ ุงุตู"
      }
    ],
    "priority_order": [1, 2, 0]
  }
}
```

> ๐ **ุงุฏุขูุฑ:** ุชุงุจุน `load_policy()` ุฏุฑ `app/core/policy_loader.py` ููุท `config/policy.json` ุฑุง ูโุฎูุงูุฏ. ูุฑ ุชุบุฑ ฺฉู ุฏุฑ ูุงูุจโูุง ุฏฺฏุฑ ุงุนูุงู ุดูุฏ (ูุซู `policy.yaml`) ุฏุฑ ุงุฌุฑุง ุงุซุฑ ูุฏุงุฑุฏ ูฺฏุฑ ุงูโฺฉู ูุจู ุงุฒ ุงุฌุฑุง ุจู JSON ูุฑุฌุน ููุชูู ุดูุฏ.

### ุงุณุชูุงุฏู ุงุฒ ุทุฑู UI

1. ุฏุฑ ุชุจ "ุชุฎุตุต"ุ ุจุฎุด "ูุฏุฑุช ูุฑุงฺฉุฒ" ุฑุง ูพุฏุง ฺฉูุฏ
2. ุจุฑุง ูุฑ ูุฑฺฉุฒุ ูุฏุฑ ููุฑุฏ ูุธุฑ ุฑุง ุงุฒ dropdown ุงูุชุฎุงุจ ฺฉูุฏ
3. ุงุฒ ุฏฺฉููโูุง ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:
   - **ุจุงุฒูุดุงู ุจู ูพุดโูุฑุถ**: ุจุงุฒฺฏุดุช ุจู ููุงุฏุฑ Policy
   - **ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ูุฏุฑุงู**: ุจูโุฑูุฒุฑุณุงู ูุณุช ูุฏุฑุงู ุงุฒ ูุงู ุงุณุชุฎุฑ

### ุงุณุชูุงุฏู ุงุฒ ุทุฑู CLI

```bash
# ูุณุฑูุง ุงุฌุจุงุฑ (ุฏุงูุดโุขููุฒุงูุ ุงุณุชุฎุฑ ููุชูุฑูุง ู ุฎุฑูุฌ ููุง)
STUDENTS=data/StudentReport.xlsx
POOL=data/MentorPool.xlsx
OUTPUT=out/allocation.xlsx

# ุชูุธู ูุฏุฑุงู ุจุฑุง ูุฑุงฺฉุฒ ูุฎุชูู
python -m app.cli allocate \
  --students "$STUDENTS" \
  --pool "$POOL" \
  --output "$OUTPUT" \
  --center-manager 1="ุดูุฏุฎุช ฺฉุดุงูุฑุฒ" \
  --center-manager 2="ุขูุงุฒ ููุดููุฏ" \
  --center-priority 1,2,0

# ูุนุงูโุณุงุฒ validation ุณุฎุชโฺฏุฑุงูู (ููุฑุงู ุจุง ูุฑูุฏโูุง ุงุฌุจุงุฑ)
python -m app.cli allocate \
  --students "$STUDENTS" \
  --pool "$POOL" \
  --output "$OUTPUT" \
  --center-manager 1="ูุฏุฑ ฺฏูุณุชุงู" \
  --strict-manager-validation
```

### ุงูฺฏูุฑุชู ุชุฎุตุต

1. **ุฌุฏุงุณุงุฒ ุฏุงูุดโุขููุฒุงู**: 
   - ุฏุงูุดโุขููุฒุงู ูุฏุฑุณูโุง (ุจุฑ ุงุณุงุณ ุณุชูู ูุดุฎุต ุดุฏู)
   - ุฏุงูุดโุขููุฒุงู ูุฑฺฉุฒ

2. **ุชุฑุชุจ ูพุฑุฏุงุฒุด**:
   - ุงุจุชุฏุง ุชูุงู ุฏุงูุดโุขููุฒุงู ูุฏุฑุณูโุง
   - ุณูพุณ ุฏุงูุดโุขููุฒุงู ูุฑฺฉุฒ ุจู ุชุฑุชุจ ุงูููุช ูุฑุงฺฉุฒ

3. **ููุชุฑ ูุฏุฑ**:
   - ูุฑ ุฏุงูุดโุขููุฒ ููุท ุจู ูุฏุฑุงู ูุฑฺฉุฒ ุฎูุฏุด ุชุฎุตุต ูโุงุจุฏ
   - ุฏุฑ ุตูุฑุช ูุจูุฏ ูุฏุฑุ ูุดุฏุงุฑ ุฏุงุฏู ูโุดูุฏ

### ุนุจโุงุจ

**ูุดฺฉู: ูุฏุฑุงู ุฏุฑ dropdown ูุดุงู ุฏุงุฏู ููโุดููุฏ**
- ูุทูุฆู ุดูุฏ ูุงู ุงุณุชุฎุฑ ุงูุชุฎุงุจ ุดุฏู ุงุณุช
- ุจุฑุฑุณ ฺฉูุฏ ุณุชูู `manager_name` ุฏุฑ ูุงู ุงุณุชุฎุฑ ูุฌูุฏ ุฏุงุฑุฏ

**ูุดฺฉู: ุฏุงูุดโุขููุฒุงู ุจู ูุฏุฑ ุงุดุชุจุงู ุชุฎุตุต ูโุงุจูุฏ**
- ููุงุฏุฑ ูุฑฺฉุฒ ุฏุงูุดโุขููุฒุงู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุชูุธูุงุช ูุฏุฑุงู ูุฑ ูุฑฺฉุฒ ุฑุง ุจุฑุฑุณ ฺฉูุฏ

**ูุดฺฉู: ุฎุทุง "ูุฑฺฉุฒ ูุงูุนุชุจุฑ"**
- ููุงุฏุฑ ูุฑฺฉุฒ ุฏุฑ ุฏุชุง ุฏุงูุดโุขููุฒุงู ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุงุฒ `default_center_for_invalid` ุฏุฑ Policy ุงุณุชูุงุฏู ฺฉูุฏ

## ูุดุฏุงุฑ ุฎุฑูุฌ Excel

- ูุงูโูุง Excel ุชููุฏุดุฏู ูููุชโูุง Vazir/Vazirmatn ุฑุง **ุฌุงุณุงุฒ ููโฺฉููุฏ**ุ ุจุฑุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุจุง ุณุณุชูโูุง ูุงูุฏ ูููุชุ ุฎุฑูุฌ ุฑุง ุจู PDF ุชุจุฏู ฺฉูุฏ.

## ูุณุชูุฏุงุช ุชฺฉูู

- ุฑุงูููุง ฺฉุงูู ุงูพุฑุงุชูุฑ GUI: [docs/SmartAlloc_GUI_Operator_Guide.fa.md](docs/SmartAlloc_GUI_Operator_Guide.fa.md)
- ฺฺฉโูุณุช QA ุณุฑุชุงุณุฑ: [docs/SmartAlloc_E2E_QA_Checklist.fa.md](docs/SmartAlloc_E2E_QA_Checklist.fa.md)
- ูฺฉุงุช QA ุจุฑุง ุชู ุชูุณุนู: [docs/SmartAlloc_Dev_QA_Notes.md](docs/SmartAlloc_Dev_QA_Notes.md)
